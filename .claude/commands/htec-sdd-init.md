---
name: htec-sdd-init
description: Initialize Implementation stage folder structure with placeholder files
argument-hint: <SystemName>
model: claude-sonnet-4-5-20250929
allowed-tools: Read, Write, Edit, Bash, Grep, Glob
hooks:
  PreToolUse:
    - matcher: "*"
      once: true
      hooks:
        - type: command
          command: "$CLAUDE_PROJECT_DIR/.claude/hooks/log-lifecycle.sh" command /htec-sdd-init started '{"stage": "implementation"}'
  Stop:
    - hooks:
        - type: command
          command: "$CLAUDE_PROJECT_DIR/.claude/hooks/log-lifecycle.sh" command /htec-sdd-init ended '{"stage": "implementation"}'
---

## FIRST ACTION (MANDATORY)

Before doing ANYTHING else, run these commands:

```bash
# 1. Validate session (WARNING only - won't block execution)
python3 "$CLAUDE_PROJECT_DIR/.claude/hooks/validate_session.py" --warn-only || true

# 2. Update session context
bash "$CLAUDE_PROJECT_DIR/.claude/hooks/session-update.sh" --project "{SystemName}" --stage "implementation"

# 3. Log command start
bash .claude/hooks/log-lifecycle.sh command /htec-sdd-init instruction_start '{"stage": "implementation"}'
```

---

## Usage

```bash
/htec-sdd-init <SystemName>
/htec-sdd-init InventorySystem
/htec-sdd-init ERTriage --monorepo  # For monorepo projects
```

## Arguments

- `<SystemName>`: Name of the system (e.g., InventorySystem, ERTriage)

## Options

| Option | Description | Default |
|--------|-------------|---------|
| `--monorepo` | Use monorepo structure (packages/) | false |
| `--force` | Overwrite existing structure | false |

---

## Prerequisites

- ProductSpecs Stage 3 completed (CP8+)
- SolArch Stage 4 completed (CP12+)

---

## Procedure

### 1. Validate Prerequisites

```bash
# Check ProductSpecs exists
if [ ! -d "ProductSpecs_${SYSTEM_NAME}" ]; then
    echo "❌ ProductSpecs_${SYSTEM_NAME}/ not found"
    echo "   Run /productspecs ${SYSTEM_NAME} first"
    exit 1
fi

# Check SolArch exists
if [ ! -d "SolArch_${SYSTEM_NAME}" ]; then
    echo "❌ SolArch_${SYSTEM_NAME}/ not found"
    echo "   Run /solarch ${SYSTEM_NAME} first"
    exit 1
fi
```

### 2. Create Folder Structure

Create the Implementation folder with all required subdirectories:

```bash
IMPL_DIR="Implementation_${SYSTEM_NAME}"

# Create main folder structure
mkdir -p "${IMPL_DIR}/00-setup"
mkdir -p "${IMPL_DIR}/01-tasks"
mkdir -p "${IMPL_DIR}/02-implementation"
mkdir -p "${IMPL_DIR}/03-tests"
mkdir -p "${IMPL_DIR}/04-reports"
mkdir -p "${IMPL_DIR}/05-documentation"
mkdir -p "${IMPL_DIR}/pr-metadata"
mkdir -p "${IMPL_DIR}/reports"
mkdir -p "${IMPL_DIR}/scripts"
mkdir -p "${IMPL_DIR}/feedback-sessions"

# For monorepo projects, also create packages structure
if [ "$MONOREPO" = true ]; then
    mkdir -p "${IMPL_DIR}/packages/api/src"
    mkdir -p "${IMPL_DIR}/packages/api/tests"
    mkdir -p "${IMPL_DIR}/packages/web/src"
    mkdir -p "${IMPL_DIR}/packages/web/tests"
    mkdir -p "${IMPL_DIR}/packages/shared/src"
fi
```

### 3. Create Placeholder Files (MANDATORY)

**CRITICAL**: Every folder MUST have a `_readme.md` file explaining:
- What content belongs in this folder
- Where the content is (if using alternative structure like monorepo)
- Why it's empty (if not yet generated)
- Which command/phase generates the content

Create these placeholder files:

#### 00-setup/_readme.md
```markdown
# 00-setup

## Status: Pending - Generated by /htec-sdd-validate

This folder contains project scaffolding and setup documentation.

## Expected Content

| File | Purpose | Generated By |
|------|---------|--------------|
| `project-scaffold.md` | Project structure decisions | /htec-sdd-validate |
| `dependency-manifest.json` | All dependencies with versions | /htec-sdd-validate |
| `environment-config.md` | Environment setup guide | /htec-sdd-validate |
| `input-validation.md` | Input validation report | /htec-sdd-validate |

## Generation Command

```bash
/htec-sdd-validate {SystemName}
```

---

*This placeholder created by /htec-sdd-init. Content will be generated in subsequent phases.*
```

#### 01-tasks/_readme.md
```markdown
# 01-tasks

## Status: Pending - Generated by /htec-sdd-tasks

This folder contains task specifications and execution logs.

## Expected Content

| File/Folder | Purpose | Generated By |
|-------------|---------|--------------|
| `TASK_INDEX.md` | Master task list | /htec-sdd-tasks |
| `T-*.md` | Individual task specifications | /htec-sdd-tasks |
| `<T-ID>/results/` | Per-task execution results | /htec-sdd-implement |
| `TASK_EXECUTION_LOG.md` | Execution history | /htec-sdd-implement |

## Generation Command

```bash
/htec-sdd-tasks {SystemName}
```

---

*This placeholder created by /htec-sdd-init. Content will be generated in subsequent phases.*
```

#### 02-implementation/_readme.md (Standard Structure)
```markdown
# 02-implementation

## Status: Pending - Generated by /htec-sdd-implement

This folder contains production source code and test suites.

## Expected Content (Standard Structure)

| Folder | Purpose | Generated By |
|--------|---------|--------------|
| `src/` | Production source code | /htec-sdd-implement |
| `tests/` | Test suites (unit, integration, e2e) | /htec-sdd-implement |
| `config/` | Configuration files | /htec-sdd-implement |
| `test-specs/` | Test specification documents | /htec-sdd-implement (Phase 3) |

## For Monorepo Projects

If this project uses a monorepo structure, code lives in `packages/` instead:
- `packages/api/` - Backend code
- `packages/web/` - Frontend code
- `packages/shared/` - Shared types

## Generation Command

```bash
/htec-sdd-implement {SystemName} --task T-001
```

---

*This placeholder created by /htec-sdd-init. Content will be generated during implementation.*
```

#### 02-implementation/_readme.md (Monorepo Structure)
For monorepo projects, use this content instead:
```markdown
# 02-implementation

## Status: Monorepo Pattern - See `packages/`

This folder is empty because this implementation uses a **monorepo architecture**.

## Where to Find the Code

| Content Type | Location | Description |
|--------------|----------|-------------|
| **Backend/API** | `packages/api/` | NestJS/Express backend |
| **Frontend/Web** | `packages/web/` | React/Vue frontend |
| **Shared Types** | `packages/shared/` | DTOs, interfaces, validation |
| **Tests** | `packages/*/tests/` | Tests co-located with source |
| **Config** | Root + `packages/*/` | Package-level configs |

## Monorepo Structure

```
Implementation_{SystemName}/
├── packages/
│   ├── api/           # Backend
│   │   ├── src/
│   │   └── tests/
│   ├── web/           # Frontend
│   │   ├── src/
│   │   └── tests/
│   └── shared/        # Shared code
│       └── src/
├── docker-compose.yml
├── pnpm-workspace.yaml
└── package.json
```

## Why Monorepo?

1. **Separation of Concerns**: Backend and frontend independently deployable
2. **Shared Code**: Common types and validation in one place
3. **Independent Testing**: Each package has its own test suite
4. **Modern Practice**: Aligns with NestJS + React best practices

---

*This placeholder created by /htec-sdd-init per framework convention.*
```

#### 03-tests/_readme.md
```markdown
# 03-tests

## Status: Pending - Tests Generated by /htec-sdd-implement

This folder aggregates test-related outputs.

## Note on Architecture Naming

The original architecture planned this folder as `03-review/` (code review outputs).
If code reviews are generated, they go to `reports/` folder instead.

## Expected Content

| File/Folder | Purpose | Generated By |
|-------------|---------|--------------|
| Test suites | Unit, integration, E2E tests | /htec-sdd-implement (Phase 4-5) |

## For Standard Projects

Tests are generated in `02-implementation/tests/`.

## For Monorepo Projects

Tests are co-located with source code in `packages/*/tests/`.

---

*This placeholder created by /htec-sdd-init. See alternative locations for test content.*
```

#### 04-reports/_readme.md
```markdown
# 04-reports

## Status: Pending - Generated by /htec-sdd-implement and /htec-sdd-review

This folder contains build artifacts and deployment configurations.

## Note on Architecture Naming

The original architecture planned this folder as `04-build/` (build outputs).
Build artifacts are generated by package managers in `packages/*/dist/` (monorepo)
or `02-implementation/dist/` (standard).

## Expected Content

| File | Purpose | Generated By |
|------|---------|--------------|
| `build-log.md` | Build execution log | /htec-sdd-implement |
| `artifacts/` | Build outputs | Package manager (pnpm/npm build) |
| `deployment-config/` | Docker, K8s manifests | /htec-sdd-implement |

## For Monorepo Projects

Build outputs are managed by monorepo tooling:
- `packages/api/dist/` - Backend build
- `packages/web/dist/` - Frontend build
- `docker-compose.yml` - Local deployment

---

*This placeholder created by /htec-sdd-init. Content location depends on project structure.*
```

#### 05-documentation/_readme.md
```markdown
# 05-documentation

## Status: Pending - Generated by /htec-sdd-implement (Phase 7)

This folder contains implementation documentation.

## Expected Content

| File | Purpose | Generated By |
|------|---------|--------------|
| `IMPLEMENTATION_GUIDE.md` | Developer setup and workflow | implementation-documenter agent |
| `API_REFERENCE.md` | Generated API documentation | implementation-documenter agent |
| `TEST_PLAN.md` | Test strategy and coverage | implementation-documenter agent |
| `RUNBOOK.md` | Operations and deployment guide | implementation-documenter agent |
| `api/*.md` | Per-feature API docs | implementation-documenter agent |

## Generation

Documentation is generated in **Phase 7** of `/htec-sdd-implement`:

```bash
/htec-sdd-implement {SystemName} --task T-001
# Phase 7: Documentation & PR Prep will generate docs
```

## Existing Documentation

Some documentation may exist in other locations:
- `README.md` - Project quick start
- `src/features/*/_readme.md` - Module-level READMEs (inline docs convention)

---

*This placeholder created by /htec-sdd-init. Content generated in Phase 7 of implementation.*
```

#### pr-metadata/_readme.md
```markdown
# pr-metadata

## Status: Pending - Generated by /htec-sdd-implement (Phase 7)

This folder contains PR descriptions and metadata.

## Expected Content

| File Pattern | Purpose | Generated By |
|--------------|---------|--------------|
| `PR-{N}.md` | PR group metadata | /htec-sdd-tasks |
| `PR-{N}-description.md` | Full PR description | implementation-pr-preparer agent |

## PR Description Contents

Each PR description includes:
- Summary of changes
- Files created/modified
- Test results
- Traceability links (Pain Points → Requirements → Tasks)
- Review guidance

## Generation

PR descriptions are generated in **Phase 7** of `/htec-sdd-implement`:

```bash
/htec-sdd-implement {SystemName} --pr-group PR-001
# Phase 7 generates: pr-metadata/PR-001-description.md
```

---

*This placeholder created by /htec-sdd-init. Content generated in Phase 7 of implementation.*
```

#### reports/_readme.md
```markdown
# reports

## Status: Pending - Generated by /htec-sdd-implement and /htec-sdd-review

This folder contains quality reports and validation results.

## Expected Content

| File | Purpose | Generated By |
|------|---------|--------------|
| `CODE_REVIEW.md` | Multi-agent code review findings | /htec-sdd-review or Phase 6 |
| `review-findings.json` | Structured review data | /htec-sdd-review or Phase 6 |
| `VALIDATION_REPORT.md` | Final validation report | /htec-sdd-implement (Phase 8) |
| `IMPLEMENTATION_SUMMARY.md` | Implementation summary | /htec-sdd-implement (Phase 8) |
| `INTEGRATION_REPORT.md` | Integration test results | /htec-sdd-integrate |

## Quality Agents

Reports are generated by 6 parallel quality agents in Phase 6:
- quality-bug-hunter
- quality-security-auditor
- quality-code-quality
- quality-test-coverage
- quality-contracts-reviewer
- quality-accessibility-auditor

---

*This placeholder created by /htec-sdd-init. Content generated during implementation and review.*
```

### 4. Create Configuration Files

Create `_state/implementation_config.json`:

```json
{
  "schema_version": "1.0.0",
  "system_name": "{SystemName}",
  "created_at": "{timestamp}",
  "source": {
    "productspecs_path": "ProductSpecs_{SystemName}/",
    "solarch_path": "SolArch_{SystemName}/"
  },
  "target": {
    "output_path": "Implementation_{SystemName}/",
    "structure": "standard|monorepo"
  },
  "execution": {
    "parallel_enabled": true,
    "max_parallel_agents": 3,
    "tdd_required": true
  },
  "current_checkpoint": 0
}
```

Create `_state/implementation_progress.json`:

```json
{
  "current_checkpoint": 0,
  "checkpoints": {
    "0": {
      "status": "completed",
      "timestamp": "{timestamp}"
    }
  }
}
```

### 5. Log Version History

```bash
python3 .claude/hooks/version_history_logger.py \
  "traceability/" \
  "{SystemName}" \
  "implementation" \
  "$(python3 .claude/hooks/get_user_context.py)" \
  "1.0.0" \
  "Initialized Implementation stage with placeholder files" \
  "Implementation_{SystemName}" \
  "_state/implementation_config.json,Implementation_{SystemName}/**/_readme.md" \
  "creation"
```

---

## Output

```
═══════════════════════════════════════════════════════════
✅ Implementation Stage Initialized: {SystemName}
═══════════════════════════════════════════════════════════

Structure: {"standard" | "monorepo"}

Folders Created:
  ✓ Implementation_{SystemName}/00-setup/
  ✓ Implementation_{SystemName}/01-tasks/
  ✓ Implementation_{SystemName}/02-implementation/
  ✓ Implementation_{SystemName}/03-tests/
  ✓ Implementation_{SystemName}/04-reports/
  ✓ Implementation_{SystemName}/05-documentation/
  ✓ Implementation_{SystemName}/pr-metadata/
  ✓ Implementation_{SystemName}/reports/
  ✓ Implementation_{SystemName}/scripts/

Placeholder Files Created:
  ✓ 00-setup/_readme.md
  ✓ 01-tasks/_readme.md
  ✓ 02-implementation/_readme.md
  ✓ 03-tests/_readme.md
  ✓ 04-reports/_readme.md
  ✓ 05-documentation/_readme.md
  ✓ pr-metadata/_readme.md
  ✓ reports/_readme.md

Configuration:
  ✓ _state/implementation_config.json
  ✓ _state/implementation_progress.json

Checkpoint: 0 (Initialize) ✓

Next Steps:
  1. /htec-sdd-validate {SystemName}  # Validate inputs
  2. /htec-sdd-tasks {SystemName}     # Generate task breakdown
  3. /htec-sdd-implement {SystemName} # Start implementation

═══════════════════════════════════════════════════════════
```

---

## Related Commands

- `/htec-sdd-validate` - Validate inputs (next step)
- `/htec-sdd-tasks` - Generate task breakdown
- `/htec-sdd-implement` - Start implementation
- `/htec-sdd-status` - Check progress
