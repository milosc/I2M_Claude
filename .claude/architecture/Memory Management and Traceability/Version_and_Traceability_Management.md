# Framework Governance: Versioning and Audit Traceability

**Version**: 1.0.0
**Created**: 2025-12-29
**Status**: ✅ IMPLEMENTED
**Author**: HTEC ClaudeCode Accelerators Team

---

## Executive Summary

To ensure enterprise-grade accountability and consistency, the HTEC AI I2M framework employs a centralized versioning and audit logging system. This system prevents "version drift" between stages and maintains a permanent, machine-readable audit trail of every modification made by the AI.

---

## 1. Global Version State Registry (`version.json`)

All artifacts generated by the framework (Documentation, JSON, Code) follow a unified semantic versioning strategy controlled by a global registry.

### Source of Truth
- **File**: `.claude/version.json`
- **Purpose**: Defines the target `MAJOR` and `MINOR` versions for the entire system at any given time.

### Versioning Logic
The `VERSION_CONTROL_STANDARD` skill applies the following logic during any file modification:
1. **Read Registry**: Get `target_major` and `target_minor`.
2. **Comparison**:
   - If the file's current version matches the registry's Major/Minor → **Increment Patch** (e.g., `1.2.1` → `1.2.2`).
   - If the registry has been bumped (Major or Minor changed) → **Reset Patch to 0** (e.g., `1.2.5` → `2.0.0`).
3. **Auto-Initialization**: If the registry is missing, it is automatically initialized to `1.0`.

### Management Command
- `/version-bump <major|minor> [value]` - Updates the global state.

---

## 2. Global Traceability Version History

Every action taken by an agent (Creation, Modification, Deletion) is recorded in a centralized, strongly-typed audit log.

### Audit Log
- **File**: `traceability/{system_name}_version_history.json`
- **Schema**: `.claude/templates/traceability/schemas/version_history.schema.json`
- **Format**: JSON
- **Retention**: Permanent (lives at project root)

### Field Definitions

| Field | Type | Description |
|-------|------|-------------|
| `timestamp` | String | ISO 8601 date and time of the change. |
| `stage` | Enum | The pipeline stage (`discovery`, `prototype`, `productspecs`, `solarch`, `implementation`, `governance`). |
| `author` | String | The entity that made the change (e.g., `Claude`, `human`, or a specific skill). |
| `version` | String | Semantic version `X.Y.Z` assigned after the change. |
| `action` | Enum | Type of operation: `creation`, `modification`, or `deletion`. |
| `file` | String | Relative path to the affected file. |
| `reason` | String | A single-sentence justification for the change. |
| `references`| Array | List of Traceability IDs (e.g., `PP-1.1`, `US-001`) linking back to requirements. |

---

## 3. The Traceability Guard (Enforcement)

Framework integrity is maintained through a mandatory "Guard" pattern.

### The Rule (`.claude/rules/traceability-guard.md`)
The framework defines an "Iron Rule": **No file change is complete until it is logged.** Agents are instructed to fail the task if they cannot update the history.

### The Hook (`.claude/hooks/version_history_logger.py`)
To prevent manual JSON formatting errors by agents, a centralized Python hook handles the logging.
- **Atomic Operations**: Ensures the history file is never corrupted by concurrent or failed writes.
- **Standardized Metadata**: Automatically handles timestamps and structure.

---

## 4. Cross-Stage Integration

These governance tools act as the "connective tissue" between the five stages:

| Stage | Versioning Source | History Destination |
|-------|-------------------|---------------------|
| Stage 1: Discovery | `.claude/version.json` | `traceability/*_history.json` |
| Stage 2: Prototype | `.claude/version.json` | `traceability/*_history.json` |
| Stage 3: ProductSpecs| `.claude/version.json` | `traceability/*_history.json` |
| Stage 4: SolArch | `.claude/version.json` | `traceability/*_history.json` |
| Stage 5: Implementation| `.claude/version.json` | `traceability/*_history.json` |

---

## Usage Scenarios

### Auditing a Change
If a bug is found in Stage 5, a human can look at the `version_history.json` to see:
1. When the file was first created.
2. Which `JTBD-` or `PP-` ID it traces back to.
3. Which agent modified it last and what the stated reason was.

### Coordinating a Release
When moving from MVP (`1.x`) to v2 (`2.x`), the user runs `/version-bump major 2`. Every subsequent file modification across any stage will now automatically align with the `2.0.x` numbering scheme.

---

**Standard Version**: 1.0.0
**Updated**: 2025-12-29
